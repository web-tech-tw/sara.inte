import{r as l,u as x,c as i,o as y,a as w,b as u,t as p,d as j,e as k,f as B}from"./index-b0068cdf.js";import{_ as C}from"./InputModal-fa20f6c6.js";const R={class:"flex justify-center my-8 py-16"},S={class:"flex flex-col"},V={class:"input-label text-base mb-2"},$={class:"input-label text-base mb-2 text-red-600"},A={__name:"HomeView",setup(q){const c=l(!1),t=l(""),a=l(""),d=B(),_=x(),m=i(()=>a.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),v=i(()=>a.value?"例如：123456":"例如：sara@web-tech-tw.github.io"),f=i(()=>a.value?"請於您的電子郵件信箱收取登入代碼。":""),h=s=>{if(!s){t.value="請輸入資料";return}t.value="",c.value=!0,a.value?g(s):b(s),c.value=!1},b=async s=>{var n,o;try{const r=await(await d.post("tokens",{json:{email:s}})).json();r!=null&&r.session_id?a.value=r.session_id:t.value="發生錯誤 (無錯誤代碼)"}catch(e){if(((n=e==null?void 0:e.response)==null?void 0:n.status)===404)sessionStorage.setItem("sara_register_email",s),_.push("/register");else{const r=((o=e==null?void 0:e.response)==null?void 0:o.status)||"無錯誤代碼";t.value=`發生錯誤 (${r})`,console.error(e.message)}}},g=async s=>{var n;try{await d.patch("tokens",{json:{session_id:a.value,code:s}}),t.value="登入成功，正在寫入憑證...",k()}catch(o){const e=((n=o==null?void 0:o.response)==null?void 0:n.status)||"無錯誤代碼";t.value=`發生錯誤 (${e})`,console.error(o.message)}};return(s,n)=>(y(),w("div",R,[u("div",S,[u("label",V,p(m.value),1),u("p",$,p(t.value),1),j(C,{loading:c.value,placeholder:v.value,description:f.value,onSubmit:h},null,8,["loading","placeholder","description"])])]))}};export{A as default};
