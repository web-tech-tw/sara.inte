import{r as i,u as x,c as u,o as y,a as w,b as l,t as m,d as j,F as k,f as C}from"./index-b0068cdf.js";import{_ as B}from"./InputModal-fa20f6c6.js";const R={class:"flex justify-center my-8 py-16"},V={class:"flex flex-col"},$={class:"input-label text-base mb-2"},q={class:"input-label text-base mb-2 text-red-600"},N={__name:"ManageEmailView",setup(E){const c=i(!1),a=i(""),o=i(""),r=x(),d=C(),p=u(()=>o.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),v=u(()=>o.value?"例如：12345678":"例如：sara@web-tech-tw.github.io"),_=u(()=>o.value?"請於您的新的電子郵件信箱收取轉移代碼。":""),f=()=>{window.history.length?r.back():r.replace("/")},b=s=>{if(!s){a.value="請輸入資料";return}a.value="",c.value=!0,o.value?g(s):h(s),c.value=!1},h=async s=>{var n;try{const t=await(await d.put("users/me/email",{json:{email:s}})).json();t!=null&&t.session_id?o.value=t.session_id:a.value="發生錯誤 (無錯誤代碼)"}catch(e){const t=((n=e==null?void 0:e.response)==null?void 0:n.status)||"無錯誤代碼";a.value=`發生錯誤 (${t})`,console.error(e.message)}},g=async s=>{var n;try{await d.patch("users/me/email",{json:{session_id:o.value,code:s}}),a.value="修改成功，正在寫入憑證...",setTimeout(()=>r.replace("/manage"),500)}catch(e){const t=((n=e==null?void 0:e.response)==null?void 0:n.status)||"無錯誤代碼";a.value=`發生錯誤 (${t})`,console.error(e.message)}};return(s,n)=>(y(),w(k,null,[l("div",R,[l("div",V,[l("label",$,m(p.value),1),l("p",q,m(a.value),1),j(B,{loading:c.value,placeholder:v.value,description:_.value,onSubmit:b},null,8,["loading","placeholder","description"])])]),l("div",{class:"flex justify-center mt-5"},[l("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:f}," 取消 ")])],64))}};export{N as default};
