import{r as i,u as k,c as u,g as w,o as C,a as R,b as l,t as m,d as j,e as B,f as S}from"./index-304ee9d1.js";import{_ as V}from"./InputModal-93e7e797.js";const $={class:"flex justify-center my-8 py-16"},q={class:"flex flex-col"},M={class:"input-label text-base mb-2"},N={class:"input-label text-base mb-2 text-red-600"},E={__name:"RegisterView",props:{email:String},setup(v){const d=v,r=i(!1),t=i(""),a=i(""),n=k(),p=S(),f=u(()=>a.value?"請輸入您的註冊代碼：":"請輸入您的暱稱："),_=u(()=>a.value?"例如：1234567":"例如：星川 サラ"),h=u(()=>a.value?"請於您的電子郵件信箱收取註冊代碼。":""),b=()=>{n.history.length?n.back():n.replace("/")},x=e=>{if(!e){t.value="請輸入資料";return}t.value="",r.value=!0,a.value?g(e):y(e),r.value=!1},y=async e=>{var o;try{(await(await p.post("users",{email:d.email,nickname:e})).json()).session_id?a.value=xhr.data.session_id:t.value="發生錯誤 (無錯誤代碼)"}catch(s){const c=((o=s==null?void 0:s.response)==null?void 0:o.status)||"無錯誤代碼";t.value=`發生錯誤 (${c})`}},g=async e=>{var o;try{await p.patch("users",{code:e,session_id:a.value}),t.value="註冊成功，正在寫入憑證...",B()}catch(s){const c=((o=s==null?void 0:s.response)==null?void 0:o.status)||"無錯誤代碼";t.value=`發生錯誤 (${c})`}};return w(()=>{d.email===null&&n.replace("/")}),(e,o)=>(C(),R("div",null,[l("div",$,[l("div",q,[l("label",M,m(f.value),1),l("p",N,m(t.value),1),j(V,{loading:r.value,placeholder:_.value,description:h.value,onSubmit:x},null,8,["loading","placeholder","description"])])]),l("div",{class:"flex justify-center mt-5"},[l("button",{onClick:b,class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3"}," 取消 ")])]))}};export{E as default};
