import{r as i,u as k,c as u,g as w,o as j,a as C,b as l,t as m,d as R,e as B,f as S}from"./index-a1c3f9d4.js";import{_ as V}from"./InputModal-2fe273ea.js";const $={class:"flex justify-center my-8 py-16"},q={class:"flex flex-col"},M={class:"input-label text-base mb-2"},N={class:"input-label text-base mb-2 text-red-600"},E={__name:"RegisterView",props:{email:String},setup(v){const d=v,r=i(!1),a=i(""),o=i(""),c=k(),p=S(),f=u(()=>o.value?"請輸入您的註冊代碼：":"請輸入您的暱稱："),_=u(()=>o.value?"例如：1234567":"例如：星川 サラ"),b=u(()=>o.value?"請於您的電子郵件信箱收取註冊代碼。":""),h=()=>{c.history.length?c.back():c.replace("/")},x=s=>{if(!s){a.value="請輸入資料";return}a.value="",r.value=!0,o.value?y(s):g(s),r.value=!1},g=async s=>{var n;try{const t=await(await p.post("users",{json:{email:d.email,nickname:s}})).json();t!=null&&t.session_id?o.value=t.session_id:a.value="發生錯誤 (無錯誤代碼)"}catch(e){const t=((n=e==null?void 0:e.response)==null?void 0:n.status)||"無錯誤代碼";a.value=`發生錯誤 (${t})`,console.error(e.message)}},y=async s=>{var n;try{await p.patch("users",{json:{session_id:o.value,code:s}}),a.value="註冊成功，正在寫入憑證...",B()}catch(e){const t=((n=e==null?void 0:e.response)==null?void 0:n.status)||"無錯誤代碼";a.value=`發生錯誤 (${t})`,console.error(e.message)}};return w(()=>{d.email===null&&c.replace("/")}),(s,n)=>(j(),C("div",null,[l("div",$,[l("div",q,[l("label",M,m(f.value),1),l("p",N,m(a.value),1),R(V,{loading:r.value,placeholder:_.value,description:b.value,onSubmit:x},null,8,["loading","placeholder","description"])])]),l("div",{class:"flex justify-center mt-5"},[l("button",{onClick:h,class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3"}," 取消 ")])]))}};export{E as default};
