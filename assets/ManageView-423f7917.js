import{r as u,c as x,g as y,h as w,o,a,b as e,t as r,i as l,F as k,j as f,k as E,w as S,v as T,d as A,l as V,f as C}from"./index-405296c8.js";const R={class:"flex justify-center my-8 py-16"},N={key:0,class:"flex flex-col mx-5 md:mx-auto"},I={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},O={key:0,class:"overflow-hidden shadow-md"},D={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},M={class:"p-6 bg-white border-b border-gray-200"},B=e("span",{class:"text-gray-600"},"暱稱：",-1),j=e("br",null,null,-1),H=e("span",{class:"text-gray-600"},"電子郵件地址：",-1),U=e("br",null,null,-1),F=e("span",{class:"text-gray-600"},"Sara系統使用者識別碼：",-1),L={class:"p-6 bg-white border-b border-gray-200 text-right"},$={key:0,class:"p-6 bg-white border-b border-gray-200"},K=e("span",{class:"text-gray-600"},"持有權限：",-1),P={class:"list-disc ml-7"},q={key:1,class:"overflow-hidden shadow-md"},z=e("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改個人資料： ",-1),G={class:"p-6 bg-white border-b border-gray-200"},J={class:"flex rounded bg-white"},Q=e("label",{class:"px-4 py-1 text-gray-600",for:"nickname"},"暱稱：",-1),W={class:"p-6 bg-white border-b border-gray-200"},X={class:"p-6 bg-white border-gray-200 text-right"},Y={key:1},te={__name:"ManageView",setup(Z){const{VITE_SARA_INTE_HOST:b}={VITE_SARA_INTE_HOST:"https://web-tech-tw.github.io/sara.inte",VITE_SARA_RECV_HOST:"https://web-tech-tw.eu.org/sara.recv",VITE_SARA_TOKEN_NAME:"unified_token",BASE_URL:"/sara.inte",MODE:"production",DEV:!1,PROD:!0,SSR:!1},c=u(!1),d=u({nickname:""}),t=u(null),_=C(),h=x(()=>{var n;return Array.isArray((n=t.value)==null?void 0:n.roles)&&t.value.roles.length}),m=async()=>{await _.put("users/me",{nickname:d.value.nickname}),setTimeout(()=>location.reload(),500)},p=()=>{localStorage.clear(),location.assign(b)};return y(async()=>{try{const s=await(await _.get("users/me")).json();t.value=s.profile,d.value.nickname=s.nickname}catch(n){console.warn(n.message)}}),(n,s)=>{const g=w("router-link");return o(),a("div",R,[t.value?(o(),a("div",N,[e("div",I,[c.value?(o(),a("div",q,[z,e("div",G,[e("div",J,[Q,S(e("input",{id:"nickname","onUpdate:modelValue":s[1]||(s[1]=i=>d.value.nickname=i),class:"border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none",placeholder:"例如：星川 サラ",type:"text"},null,512),[[T,d.value.nickname]])])]),e("div",W,[l(" 若要修改電子郵件地址，請點 "),A(g,{class:"text-amber-900",to:"/manage/email"},{default:V(()=>[l("此處")]),_:1}),l(" 。 ")]),e("div",X,[e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:s[2]||(s[2]=i=>c.value=!1)}," 取消 "),e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded",onClick:m}," 確定修改 ")])])):(o(),a("div",O,[e("div",D," 您好，"+r(t.value.nickname)+"，這裡是您的個人資料： ",1),e("div",M,[B,l(r(t.value.nickname),1),j,H,l(r(t.value.email),1),U,F,l(r(t.value._id),1)]),e("div",L,[e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",onClick:s[0]||(s[0]=i=>c.value=!0)},"修改個人資料 "),e("button",{class:"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded",onClick:p},"登出 ")]),h.value?(o(),a("div",$,[K,e("ul",P,[(o(!0),a(k,null,f(t.value.roles,(i,v)=>(o(),a("li",{key:v},r(i),1))),128))])])):E("",!0)]))])])):(o(),a("div",Y,r(t.value===null?"載入中...":"發生錯誤"),1))])}}};export{te as default};
