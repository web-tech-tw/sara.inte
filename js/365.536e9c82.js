"use strict";(self["webpackChunksara_inte"]=self["webpackChunksara_inte"]||[]).push([[365],{1365:function(s,t,e){e.r(t),e.d(t,{default:function(){return c}});var i=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",[e("div",{staticClass:"flex justify-center my-8 py-16"},[e("div",{staticClass:"flex flex-col"},[e("label",{staticClass:"input-label text-base mb-2"},[s._v(s._s(s.title))]),e("p",{staticClass:"input-label text-base mb-2 text-red-600"},[s._v(s._s(s.statusMessage))]),e("input-modal",{attrs:{loading:s.isLoading,placeholder:s.placeholder,description:s.description},on:{submit:s.submit},model:{value:s.answer,callback:function(t){s.answer=t},expression:"answer"}})],1)]),e("div",{staticClass:"flex justify-center mt-5"},[e("button",{staticClass:"\n        bg-white-500\n        shadow-md\n        text-sm text-black\n        font-bold\n        py-3\n        md:px-8\n        px-4\n        hover:bg-slate-100\n        rounded\n        mr-3\n      ",on:{click:s.cancel}},[s._v(" 取消 ")])])])},a=[],n=e(7637),l=e(3101),o={name:"HomeView",components:{InputModal:l.Z},props:{email:{type:String,required:!1,default:()=>null}},data:()=>({mode:0,isLoading:!1,sessionId:"",answer:"",statusMessage:""}),computed:{title(){return this.sessionId?"請輸入您的註冊代碼：":"請輸入您的暱稱："},placeholder(){return this.sessionId?"例如：1234567":"例如：星川 サラ"},description(){return this.sessionId?"請於您的電子郵件信箱收取註冊代碼。":""}},methods:{cancel(){this.$router.history.length?this.$router.back():this.$router.replace("/")},submit(){this.statusMessage="",this.answer?this.sessionId?this.verify():this.do():this.statusMessage="請輸入資料"},async do(){this.isLoading=!0;try{const s=await this.$axios.post("/users",{email:this.email,nickname:this.answer});s?.data?.session_id?(this.mode=3,this.sessionId=s.data.session_id):this.statusMessage="發生錯誤 (無錯誤代碼)"}catch(s){410===s?.response?.status?this.mode=1:this.statusMessage=`發生錯誤 (${s?.response?.status||"無錯誤代碼"})`}finally{this.isLoading=!1}},async verify(){this.isLoading=!0;try{await this.$axios.patch("/users",{code:this.answer,session_id:this.sessionId}),this.statusMessage="註冊成功，正在寫入憑證...",(0,n.x4)()}catch(s){this.statusMessage=`發生錯誤 (${s?.response?.status||"無錯誤代碼"})`}finally{this.isLoading=!1}}},created(){null===this.email&&this.$router.replace("/")}},r=o,d=e(1001),u=(0,d.Z)(r,i,a,!1,null,null,null),c=u.exports}}]);
//# sourceMappingURL=365.536e9c82.js.map