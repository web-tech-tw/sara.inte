"use strict";(self["webpackChunksara_inte"]=self["webpackChunksara_inte"]||[]).push([[773],{6773:function(s,t,e){e.r(t),e.d(t,{default:function(){return u}});var i=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",[e("div",{staticClass:"flex justify-center my-8 py-16"},[e("div",{staticClass:"flex flex-col"},[e("label",{staticClass:"input-label text-base mb-2"},[s._v(s._s(s.title))]),e("p",{staticClass:"input-label text-base mb-2 text-red-600"},[s._v(s._s(s.statusMessage))]),e("input-modal",{attrs:{loading:s.isLoading,placeholder:s.placeholder,description:s.description},on:{submit:s.submit},model:{value:s.answer,callback:function(t){s.answer=t},expression:"answer"}})],1)]),e("div",{staticClass:"flex justify-center mt-5"},[e("button",{staticClass:"\n        bg-white-500\n        shadow-md\n        text-sm text-black\n        font-bold\n        py-3\n        md:px-8\n        px-4\n        hover:bg-slate-100\n        rounded\n        mr-3\n      ",on:{click:s.cancel}},[s._v(" 取消 ")])])])},a=[],n=e(7637),r=e(3101),o={name:"HomeView",components:{InputModal:r.Z},props:{email:{type:String,required:!1,default:()=>null}},data:()=>({mode:0,isLoading:!1,sessionId:"",answer:"",statusMessage:""}),computed:{title(){return this.sessionId?"請輸入您的註冊代碼：":"請輸入您的暱稱："},placeholder(){return this.sessionId?"例如：1234567":"例如：星川 サラ"},description(){return this.sessionId?"請於您的電子郵件信箱收取註冊代碼。":""}},methods:{cancel(){this.$router.history.length?this.$router.back():this.$router.replace("/")},submit(){this.statusMessage="",this.answer?this.sessionId?this.verify():this.do():this.statusMessage="請輸入資料"},async do(){const s=new URLSearchParams;s.set("email",this.email),s.set("nickname",this.answer),this.isLoading=!0;try{const t=await this.$axios.post("/users",s);t?.data?.session_id?(this.mode=3,this.sessionId=t.data.session_id):this.statusMessage="發生錯誤 (無錯誤代碼)"}catch(t){410===t?.response?.status?this.mode=1:this.statusMessage=`發生錯誤 (${t?.response?.status||"無錯誤代碼"})`}finally{this.isLoading=!1}},async verify(){const s=new URLSearchParams;s.set("code",this.answer),s.set("session_id",this.sessionId),this.isLoading=!0;try{await this.$axios.patch("/users",s),this.statusMessage="註冊成功，正在寫入憑證...",(0,n.x4)()}catch(t){this.statusMessage=`發生錯誤 (${t?.response?.status||"無錯誤代碼"})`}finally{this.isLoading=!1}}},created(){null===this.email&&this.$router.replace("/")}},l=o,c=e(1001),d=(0,c.Z)(l,i,a,!1,null,null,null),u=d.exports}}]);
//# sourceMappingURL=773.223eb794.js.map