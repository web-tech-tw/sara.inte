{"version":3,"file":"js/545.99bafdd7.js","mappings":"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","sources":["webpack://sara.inte/./src/views/ManageView.vue?518c","webpack://sara.inte/../lib/atob.js","webpack://sara.inte/../lib/base64_url_decode.js","webpack://sara.inte/../lib/index.js","webpack://sara.inte/src/views/ManageView.vue","webpack://sara.inte/./src/views/ManageView.vue?6423","webpack://sara.inte/./src/views/ManageView.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"flex justify-center my-8 py-16\"},[_c('div',{staticClass:\"flex flex-col mx-5 md:mx-auto\"},[_c('div',{staticClass:\"max-w-2xl mx-auto sm:px-6 lg:px-8\"},[(!_vm.edit)?_c('div',{staticClass:\"overflow-hidden shadow-md\"},[_c('div',{staticClass:\"px-6 py-4 bg-white border-b border-gray-200 font-bold\"},[_vm._v(\" 您好，\"+_vm._s(_vm.profile.nickname)+\"，這裡是您的個人資料： \")]),_c('div',{staticClass:\"p-6 bg-white border-b border-gray-200\"},[_c('span',{staticClass:\"text-gray-600\"},[_vm._v(\"暱稱：\")]),_vm._v(_vm._s(_vm.profile.nickname)),_c('br'),_c('span',{staticClass:\"text-gray-600\"},[_vm._v(\"電子郵件地址：\")]),_vm._v(_vm._s(_vm.profile.email)),_c('br'),_c('span',{staticClass:\"text-gray-600\"},[_vm._v(\"Sara系統使用者識別碼：\")]),_vm._v(_vm._s(_vm.profile._id)+\" \")]),_c('div',{staticClass:\"p-6 bg-white border-gray-200 text-right\"},[_c('button',{staticClass:\"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3\",on:{\"click\":function($event){_vm.edit = true}}},[_vm._v(\"修改個人資料 \")]),_c('button',{staticClass:\"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded\",on:{\"click\":_vm.logout}},[_vm._v(\"登出 \")])])]):_c('div',{staticClass:\"overflow-hidden shadow-md\"},[_c('div',{staticClass:\"px-6 py-4 bg-white border-b border-gray-200 font-bold\"},[_vm._v(\" 修改個人資料： \")]),_c('div',{staticClass:\"p-6 bg-white border-b border-gray-200\"},[_c('div',{staticClass:\"flex rounded bg-white\"},[_c('label',{staticClass:\"px-4 py-1 text-gray-600\",attrs:{\"for\":\"nickname\"}},[_vm._v(\"暱稱：\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.field.nickname),expression:\"field.nickname\"}],staticClass:\"border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none\",attrs:{\"id\":\"nickname\",\"placeholder\":\"例如：星川 サラ\",\"type\":\"text\"},domProps:{\"value\":(_vm.field.nickname)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.field, \"nickname\", $event.target.value)}}})])]),_c('div',{staticClass:\"p-6 bg-white border-b border-gray-200\"},[_vm._v(\" 若要修改電子郵件地址，請點 \"),_c('router-link',{staticClass:\"text-amber-900\",attrs:{\"to\":\"/manage/email\"}},[_vm._v(\"此處\")]),_vm._v(\" 。 \")],1),_c('div',{staticClass:\"p-6 bg-white border-gray-200 text-right\"},[_c('button',{staticClass:\"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3\",on:{\"click\":function($event){_vm.edit = false}}},[_vm._v(\" 取消 \")]),_c('button',{staticClass:\"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded\",on:{\"click\":_vm.update}},[_vm._v(\" 確定修改 \")])])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * The code was extracted from:\n * https://github.com/davidchambers/Base64.js\n */\n\nvar chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\nfunction InvalidCharacterError(message) {\n    this.message = message;\n}\n\nInvalidCharacterError.prototype = new Error();\nInvalidCharacterError.prototype.name = \"InvalidCharacterError\";\n\nfunction polyfill(input) {\n    var str = String(input).replace(/=+$/, \"\");\n    if (str.length % 4 == 1) {\n        throw new InvalidCharacterError(\n            \"'atob' failed: The string to be decoded is not correctly encoded.\"\n        );\n    }\n    for (\n        // initialize result and counters\n        var bc = 0, bs, buffer, idx = 0, output = \"\";\n        // get next character\n        (buffer = str.charAt(idx++));\n        // character found in table? initialize bit storage and add its ascii value;\n        ~buffer &&\n        ((bs = bc % 4 ? bs * 64 + buffer : buffer),\n            // and if not first of each 4 characters,\n            // convert the first 8 bits to one ascii character\n            bc++ % 4) ?\n        (output += String.fromCharCode(255 & (bs >> ((-2 * bc) & 6)))) :\n        0\n    ) {\n        // try to find character in table (0-63, not found => -1)\n        buffer = chars.indexOf(buffer);\n    }\n    return output;\n}\n\nexport default (typeof window !== \"undefined\" &&\n    window.atob &&\n    window.atob.bind(window)) ||\npolyfill;","import atob from \"./atob\";\n\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(\n        atob(str).replace(/(.)/g, function(m, p) {\n            var code = p.charCodeAt(0).toString(16).toUpperCase();\n            if (code.length < 2) {\n                code = \"0\" + code;\n            }\n            return \"%\" + code;\n        })\n    );\n}\n\nexport default function(str) {\n    var output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw \"Illegal base64url string!\";\n    }\n\n    try {\n        return b64DecodeUnicode(output);\n    } catch (err) {\n        return atob(output);\n    }\n}","\"use strict\";\n\nimport base64_url_decode from \"./base64_url_decode\";\n\nexport function InvalidTokenError(message) {\n    this.message = message;\n}\n\nInvalidTokenError.prototype = new Error();\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\n\nexport default function(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified\");\n    }\n\n    options = options || {};\n    var pos = options.header === true ? 0 : 1;\n    try {\n        return JSON.parse(base64_url_decode(token.split(\".\")[pos]));\n    } catch (e) {\n        throw new InvalidTokenError(\"Invalid token specified: \" + e.message);\n    }\n}","<template>\n  <div class=\"flex justify-center my-8 py-16\">\n    <div class=\"flex flex-col mx-5 md:mx-auto\">\n      <div class=\"max-w-2xl mx-auto sm:px-6 lg:px-8\">\n        <div v-if=\"!edit\" class=\"overflow-hidden shadow-md\">\n          <div class=\"px-6 py-4 bg-white border-b border-gray-200 font-bold\">\n            您好，{{ profile.nickname }}，這裡是您的個人資料：\n          </div>\n          <div class=\"p-6 bg-white border-b border-gray-200\">\n            <span class=\"text-gray-600\">暱稱：</span>{{ profile.nickname }}<br/>\n            <span class=\"text-gray-600\">電子郵件地址：</span>{{ profile.email }}<br/>\n            <span class=\"text-gray-600\">Sara系統使用者識別碼：</span>{{ profile._id }}\n          </div>\n          <div class=\"p-6 bg-white border-gray-200 text-right\">\n            <button\n                class=\"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3\"\n                @click=\"edit = true\">修改個人資料\n            </button>\n            <button\n                class=\"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded\"\n                @click=\"logout\">登出\n            </button>\n          </div>\n        </div>\n        <div v-else class=\"overflow-hidden shadow-md\">\n          <div class=\"px-6 py-4 bg-white border-b border-gray-200 font-bold\">\n            修改個人資料：\n          </div>\n          <div class=\"p-6 bg-white border-b border-gray-200\">\n            <div class=\"flex rounded bg-white\">\n              <label class=\"px-4 py-1 text-gray-600\" for=\"nickname\">暱稱：</label>\n              <input\n                  id=\"nickname\"\n                  v-model=\"field.nickname\"\n                  class=\"border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none\"\n                  placeholder=\"例如：星川 サラ\"\n                  type=\"text\"\n              >\n            </div>\n          </div>\n          <div class=\"p-6 bg-white border-b border-gray-200\">\n            若要修改電子郵件地址，請點\n            <router-link class=\"text-amber-900\" to=\"/manage/email\">此處</router-link>\n            。\n          </div>\n          <div class=\"p-6 bg-white border-gray-200 text-right\">\n            <button\n                @click=\"edit = false\"\n                class=\"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3\"\n            >\n              取消\n            </button>\n            <button\n                class=\"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded\"\n                @click=\"update\"\n            >\n              確定修改\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport jwtDecode from 'jwt-decode';\n\nexport default {\n  name: 'ManageView',\n  data: () => ({\n    edit: false,\n    field: {\n      nickname: ''\n    }\n  }),\n  computed: {\n    profile() {\n      const token = localStorage.getItem('unified_token');\n      if (!token) {\n        return false;\n      }\n      const profile = jwtDecode(token);\n      return profile?.user || null;\n    },\n    authOptions() {\n      return {headers: {Authorization: localStorage.getItem('unified_token')}}\n    }\n  },\n  methods: {\n    update() {\n      const form = new URLSearchParams();\n      form.set('nickname', this.field.nickname);\n      this.$axios.put('/profile', form, this.authOptions)\n          .then((xhr) => {\n            if (xhr?.data?.token) {\n              this.status = '修改成功，正在更新憑證...';\n              localStorage.setItem('unified_token', xhr.data.token);\n              setTimeout(() => location.reload(), 500);\n            } else {\n              this.status = '發生錯誤 (無錯誤代碼)';\n            }\n          })\n          .catch((error) => {\n            this.status = `發生錯誤 (${error?.response?.status || '無錯誤代碼'})`;\n          });\n    },\n    logout() {\n      localStorage.clear();\n      location.assign('https://web-tech-tw.github.io')\n    }\n  },\n  mounted() {\n    this.field.nickname = this.profile.nickname;\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManageView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ManageView.vue?vue&type=template&id=781db5dc&\"\nimport script from \"./ManageView.vue?vue&type=script&lang=js&\"\nexport * from \"./ManageView.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","edit","_v","attrs","directives","name","rawName","value","field","expression","domProps","on","$event","target","composing","$set","update","_s","profile","nickname","email","_id","logout","staticRenderFns","InvalidCharacterError","message","prototype","Error","window","atob","bind","input","str","String","replace","length","bs","buffer","bc","idx","output","charAt","fromCharCode","indexOf","decodeURIComponent","m","p","code","charCodeAt","toString","toUpperCase","err","InvalidTokenError","token","options","pos","header","JSON","parse","base64_url_decode","split","e","data","computed","localStorage","getItem","user","authOptions","headers","Authorization","methods","form","URLSearchParams","set","$axios","put","then","xhr","setTimeout","catch","error","clear","location","assign","mounted","component"],"sourceRoot":""}